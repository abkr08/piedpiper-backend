{"version":3,"sources":["components/UI/SideDrawer/SideDrawer.module.css","components/UI/Navigation/Navbar.module.css","store/actions/actionCreators/callActionCreatorss.js","components/UI/Button/Button.js","containers/Call/IncomingCallNotification/IncomingCall.js","Axios.js","store/actions/actionCreators/authActionCreators.js","store/actions/actions.js","store/actions/actionCreators/chatActionCreators.js","components/UI/Input/Input.js","shared/utility.js","components/Auth/Register/Register.js","components/UI/ErrorBox/ErrorBox.js","components/Auth/Login/Login.js","components/Auth/Logout/Logout.js","components/UI/Navigation/Navbar.js","components/UI/OptionsDropbar/OptionsDropbar.js","containers/PiperChat/Contact.js","containers/PiperChat/Chat.js","components/UI/SideDrawer/JoinableRooms/JoinableRoom/JoinableRoom.js","components/UI/SideDrawer/JoinableRooms/JoinableRooms.js","components/UI/SideDrawer/SideDrawer.js","containers/Modal/Modal.js","containers/Call/Call.js","components/ChatScreenBar/ChatScreenBar.js","components/UI/Spinner/Spinner.js","containers/PiperChat/ChatScreen.js","App.js","serviceWorker.js","store/reducers/authReducer.js","store/reducers/callReducer.js","store/reducers/chatReducer.js","index.js","containers/PiperChat/ChatScreen.module.css","components/UI/Input/Input.module.css","containers/Call/Call.module.css","containers/PiperChat/Contact.module.css","containers/PiperChat/Chat.module.css","components/UI/Button/Button.module.css","containers/Call/IncomingCallNotification/IncomingCall.module.css","components/ChatScreenBar/ChatScreenBar.module.css","components/Auth/Register/Register.module.css","components/Auth/Login/Login.module.css","components/UI/ErrorBox/ErrorBox.module.css","assets/images/p37605.png","components/UI/OptionsDropbar/OptionsDropbar.module.css","components/UI/SideDrawer/JoinableRooms/JoinableRoom/JoinableRoom.module.css","containers/Modal/Modal.module.css","components/UI/Backdrop/Backdrop.module.css","components/UI/Spinner/Spinner.module.css","assets/audio/iphone_trap_remix.mp3"],"names":["module","exports","SideDrawer","Open","Close","PP","divs","RoomsList","Navbar","navIcon","fa","NavItem","Brand","connectedUser","yourConn","button","props","react_default","a","createElement","onClick","clicked","disabled","className","classes","Button","btnType","join","children","IncomingCall","callType","caller","Buttons","acceptCall","rejectCall","instance","axios","create","baseURL","checkTokenValidity","expiresIn","dispatch","setTimeout","localStorage","removeItem","logout","logInFailed","err","type","error","userId","getItem","config","conn","io","configuration","iceServers","url","stream","console","log","on","msg","candidate","offer","name","data","JSON","parse","from","handleRequest","createOffer","setRemoteDescription","RTCSessionDescription","createAnswer","answer","setLocalDescription","send","alert","handleAnswer","addIceCandidate","RTCIceCandidate","handleLeave","onerror","to","store","RTCPeerConnection","ontrack","onTrack","onicecandidate","event","getMedia","then","gotStream","catch","message","stringify","navigator","mediaDevices","getUserMedia","video","width","height","frameRate","audio","myStream","onLocalStream","getTracks","forEach","track","addTrack","remoteStream","streams","callEnded","stop","close","onaddTrack","currentUser","getRooms","contacts","rooms","map","room","obj","isPrivate","split","filter","id","length","Object","objectSpread","chatInitSuccess","subscribeToRooms","user","getState","con","subscribeToRoom","roomId","hooks","onMessage","belongsToCurrentRoom","currentRoom","chat","onNewMessage","messageLimit","getMessages","fetchMessages","direction","limit","messages","fetchMessagesSuccess","concat","input","inputElement","inputClasses","InputElement","invalid","shouldValidate","touched","push","Invalid","elementType","assign","elementConfig","value","onChange","changed","options","option","key","displayValue","Input","Label","label","updateObject","oldObject","updatedProperties","checkValidity","rules","isValid","required","trim","minLength","maxLength","isEmail","test","isNumeric","Register","state","controls","placeholder","validation","valid","email","username","password","password2","isEqual","formIsValid","inputIdentifier","target","updatedFormElement","_this","updatedForm","defineProperty","setState","onSubmit","preventDefault","_this$state$controls","control","onRegister","this","registrationSuccess","history","_this2","formElements","form","formElement","RegisterBox","Component","connect","auth","post","res","registrationFailed","actionCreators","errorBox","keys","response","authError","errorMessage","ErrorBox","Login","e","onLogIn","redirect","isLoggedIn","es_Redirect","token","_res$data","expirationDate","Date","getTime","setItem","logInSuccess","Logout","displayedElements","Link","data-text","OptionsDropbar","hideOptions","optionsRef","contains","optionClicked","deleteChat","document","addEventListener","window","onresize","removeEventListener","show","ref","ul","style","top","position","y","left","x","i","leaveRoom","chatActionCreators","_useState","useState","_useState2","slicedToArray","showOptions","toggleShowOptions","_useState3","_useState4","updatePosition","attachedClasses","Contact","unreadMessages","Active","unopenedMessages","contact","ImageContainter","src","img","alt","lastMessage","FloatedRight","stopPropagation","pos","clientX","clientY","UI_OptionsDropbar_OptionsDropbar","Chat","byCurrentUser","ByCurrentUser","Sender","sender","Text","text","joinRoom","JoinableRoom","groupImage","joinableRooms","Fragment","showCreateForm","showNewChatForm","groupName","participants","potentialParticipants","newGroupChatParticipants","privateChatParticipant","ShowJoinableRoomsList","createNewGroupHandler","chatParticipants","pp","prevState","onCreateNewGroup","j","startNewChatHandler","onStartNewChat","chatParticipant","joinGroup","getJoinableRooms","onPPChange","_event$target","checked","groupParticipants","display","isTouched","htmlFor","JoinableRooms","createRoom","private","addUserIds","customData","foo","createGroupFailed","get","headers","x-auth-token","displayImage","avatar","startNewChatFailed","Modal","modal","Call","endCall","role","closeModal","callUser","callTo","channel","localVideoRef","srcObject","localStream","remoteVideoRef","localAudioRef","remoteAudioRef","_this3","call","videoContainer","LocalVideo","autoPlay","muted","lVid","RemoteVideo","rVid","incomingCall","callActionCreators","ChatScreenBar","showModal","isVideo","onVideoCallInit","onVoiceCallInit","optionsDropbar","FA","containers_Modal_Modal","containers_Call_Call","callStarted","callOngoing","spinner","Spinner","ChatScreen","showSideDrawer","scrollToBottom","scrollRef","lastElement","scrollIntoView","sendMessage","toggleSideDrawer","chatInit","components_ChatScreenBar_ChatScreenBar","Msgs","div","senderId","contactsPane","chatkitUser","ContactsPane","UI_SideDrawer_SideDrawer","MenuBar","textAlign","ChatManager","instanceLocator","tokenProvider","TokenProvider","onAddedToRoom","App","showCallNotification","ringtoneRef","pause","currentTime","callAccepted","callRejected","onAuth","getCallerReady","chatScreen","play","IncomingCallNotification_IncomingCall","PiperChat_ChatScreen","Navigation_Navbar","ringtone","loop","ring","Switch","Route","path","component","Redirect","withRouter","authSuccess","Boolean","location","hostname","match","initialState","authReducer","arguments","undefined","action","callReducer","chatReducer","item","reduce","acc","toConsumableArray","unopenedMessagesCopy","hasOwnProperty","__webpack_require__","d","__webpack_exports__","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","rootReducer","combineReducers","createStore","applyMiddleware","thunk","ReactDOM","render","es","BrowserRouter","src_App_0","getElementById","serviceWorker","ready","registration","unregister","ImageContainer","Success","Danger","registerBox","p","Backdrop"],"mappings":"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","file":"static/js/main.8744f18b.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"SideDrawer\":\"SideDrawer_SideDrawer__32aA8\",\"Open\":\"SideDrawer_Open__3jseG\",\"Close\":\"SideDrawer_Close__3SwLL\",\"PP\":\"SideDrawer_PP__1JEf8\",\"divs\":\"SideDrawer_divs__368Yf\",\"RoomsList\":\"SideDrawer_RoomsList__17YmK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Navbar\":\"Navbar_Navbar__2sotz\",\"navIcon\":\"Navbar_navIcon__6zPpB\",\"fa\":\"Navbar_fa__1gOuQ\",\"NavItem\":\"Navbar_NavItem__2minK\",\"Brand\":\"Navbar_Brand__2bEAv\"};","import { store }  from '../../../index';\nimport * as actionTypes from '../actions';\nimport io from 'socket.io-client'; \n\nlet name; \nlet connectedUser;\nconst userId = localStorage.getItem('userId');\nconst config = {};\n\n//connecting to our signaling server\nconst conn = io('http://localhost:8082')\nconst configuration = { \n    \"iceServers\": [{ \"url\": \"stun:stun2.1.google.com:19302\" }]\n};\nconst offerOptions = {\n    offerToReceiveAudio: 1,\n    offerToReceiveVideo: 1\n};\nlet yourConn;\nlet stream = null;\n\nconsole.log(conn);\nconn.on('connection', function () { \n   console.log(\"Connected to the signaling server\"); \n});\n\nconst prepareCaller = channel => {\n    return {\n        type: actionTypes.PREPARE_CALLER,\n        channel: channel\n    }\n}\nexport const getCallerReady = () => {\n    return dispatch => {\n        send({ \n            type: \"login\", \n            name: userId\n         });   \n        dispatch(prepareCaller(conn));\n    }\n}\n//when we got a message from a signaling server \nconn.on('message', function (msg) { \n\n   console.log(\"Got message\", msg);\n\t\n   const data = JSON.parse(msg); \n\t\n   switch(data.type) { \n    case \"login\": \n        //  handleLogin(data.success); \n        console.log('logged in')\n        break; \n    case \"requestToCall\":\n        //prepare user for call\n        console.log('received a request from ' + data.from);\n        handleRequest(data.from); \n        break;\n    case \"answerToRequest\":\n        //user is ready...send them an offer\n        console.log('received an answer from ' + data.from);\n        createOffer(data.from); \n        break;\n\n    //when somebody wants to call us \n    case \"offer\": \n        handleOffer(data.offer, data.name)\n        break; \n    case \"answer\": \n        handleAnswer(data.answer, data.from); \n        break; \n    //when a remote peer sends an ice candidate to us \n    case \"candidate\": \n        handleCandidate(data.candidate); \n        break; \n    case \"leave\": \n        handleLeave(); \n        break; \n    default: \n        break; \n   }\n});\n  \nconn.onerror = function (err) { \n   console.log(\"Got error\", err); \n};\n\nconst createOffer = to => {\n    // create an offer \n    yourConn.createOffer(function (offer) { \n        send({ \n            type: \"offer\", \n            offer: offer \n        }); \n            \n        yourConn.setLocalDescription(offer); \n        }, function (error) { \n        alert(\"Error when creating an offer\"); \n        });\n}\nconst handleRequest = from => {\n    connectedUser = from;\n    store.dispatch({type: actionTypes.ON_INCOMING_CALL, callType: 'video', caller: from});\n    yourConn = new RTCPeerConnection(configuration);\n        \n        //when a remote user adds stream to the peer connection, we display it \n        yourConn.ontrack = function (stream) { \n            console.log('got remote stream');\n            console.log(stream)\n        store.dispatch(onTrack(stream));\n        };\n        console.log(yourConn);\n        // Setup ice handling \n        yourConn.onicecandidate = function (event) { \n        if (event.candidate) { \n            send({ \n                type: \"candidate\", \n                candidate: event.candidate\n            }); \n        } \n        }\n    getMedia().then(gotStream).catch(err => console.log(err));\n}\n//alias for sending JSON encoded messages \nfunction send(message) { \n   //attach the other peer username to our messages \n   if (connectedUser) { \n      message.name = connectedUser; \n   } \n\t\n   conn.send(JSON.stringify(message)); \n};\n\nconst getMedia = () => {\n    return navigator.mediaDevices.getUserMedia({\n        video: {width: 1280,\n                height: 720,\n                frameRate: 15},\n        // config.callType === 'video' ? {width: 1280,\n        //     height: 720,\n        //     frameRate: 15}: false,\n        audio: true\n      });\n}\n\nexport const callUser = (user, type) => {\n    connectedUser = user;\n    config.type = type;\n    console.log('calling ' + user + '....' );\n    return dispatch => {\n        yourConn = new RTCPeerConnection(configuration);\n        \n        //when a remote user adds stream to the peer connection, we display it \n        yourConn.ontrack = function (stream) { \n            console.log('got remote stream');\n            console.log(stream)\n        store.dispatch(onTrack(stream));\n        };\n        console.log(yourConn);\n        // Setup ice handling \n        yourConn.onicecandidate = function (event) { \n        if (event.candidate) { \n            send({ \n                type: \"candidate\", \n                candidate: event.candidate\n            }); \n        } \n        }\n        getMedia().then(gotStream)\n        .catch(e => console.log(`getUserMedia() error: ${e}`));\n        dispatch({type: actionTypes.CALL_INIT})\n        send({\n            type: 'requestToCall',\n            from: userId,\n            to: connectedUser\n        })        \n    }\n  }  \n\nconst gotStream = myStream => {\n    console.log('Received local stream');\n    stream = myStream;\n    store.dispatch(onLocalStream(myStream));\n    myStream.getTracks().forEach(track => {\n        console.log(track);\n            yourConn.addTrack(track, myStream)\n        });\n}\n\nconst onTrack = track => {\n    return {\n        type: actionTypes.ON_TRACK,\n        remoteStream: track.streams[0]\n    }\n}\n\nconst onLocalStream = stream => {\n    return {\n        type: actionTypes.ON_LOCAL_STREAM,\n        stream: stream\n    }\n}\nfunction handleOffer(offer, name) { \n    console.log('Accepting offer from ' + connectedUser);\n    yourConn.setRemoteDescription(new RTCSessionDescription(offer));\n     \n    //create an answer to an offer \n    console.log('Creating and sending answer to ' + connectedUser);\n    yourConn.createAnswer(function (answer) { \n        yourConn.setLocalDescription(answer); \n        send({ \n            type: \"answer\", \n            answer: answer,\n            from: name \n       }); \n         \n    }, function (error) { \n       alert(\"Error when creating an answer\"); \n    }); \n}\nexport const callAccepted = () => {\n    return dispatch => {\n        send({\n            type: 'answerToRequest',\n            to: connectedUser,\n            from: userId\n        })\n        dispatch({type: actionTypes.CALL_ACCEPTED})\n    }\n}\nexport const callRejected = () => {\n    return dispatch => {\n        // channel.trigger(\"client-reject\", { room: config.room, rejected: userId });\n        dispatch({type: actionTypes.CALL_REJECTED})\n    }\n}\nfunction handleAnswer(answer, name) { \n    console.log('Accepting answer from ' + name)\n   yourConn.setRemoteDescription(new RTCSessionDescription(answer)); \n};\nfunction handleCandidate(candidate) { \n    yourConn.addIceCandidate(new RTCIceCandidate(candidate)); \n};\n\nconst callEnded = () => {\n    return {\n        type: actionTypes.END_CALL\n    }\n}\nexport const endCall = () => {\n    return dispatch => {\n        console.log(connectedUser)\n        send({ \n            type: \"leave\",\n            name: connectedUser \n         }); \n        handleLeave(); \n    }\n}\n\nfunction handleLeave() { \n    connectedUser = null; \n    stream.getTracks().forEach(track => track.stop());\n    store.dispatch(callEnded()); \n    yourConn.close(); \n    yourConn.onicecandidate = null; \n    yourConn.onaddTrack = null;\n };","import React from 'react';\nimport classes from './Button.module.css';\n\nconst button = ( props ) => (\n    <button\n    onClick = {props.clicked}\n    disabled={props.disabled}\n    className={[classes.Button, classes[props.btnType]].join(' ')}\n    >{props.children}</button>\n);\n\nexport default button;","import React from 'react';\nimport Button from '../../../components/UI/Button/Button';\nimport classes from './IncomingCall.module.css';\n\nconst IncomingCall = props => (\n    <div className={classes.IncomingCall}>\n        <span>Incoming {props.callType} call from {props.caller}</span>\n        <span className={classes.Buttons}>\n            <Button clicked={props.acceptCall} btnType='Success'>Accept</Button>\n            <Button clicked={props.rejectCall} btnType='Danger'>Reject</Button>\n        </span>\n    </div>\n)\n\nexport default IncomingCall;","import axios from 'axios';\n\nconst instance = axios.create({\n    baseURL: 'http://localhost:8080/' //'https://piedpiperchat.herokuapp.com/',\n});\n\n\nexport default instance;","import * as actionTypes from '../actions';\nimport axios from '../../../Axios';\n\nconst logInSuccess = (token, userId) => {\n    return {\n        type: actionTypes.LOG_IN,\n        token: token, \n        userId: userId\n    }\n}\nconst checkTokenValidity = expiresIn => {\n    return dispatch => {\n        setTimeout(() => {\n        localStorage.removeItem(\"token\");\n        localStorage.removeItem(\"userId\");\n        localStorage.removeItem(\"expiresIn\");\n            dispatch(logout());\n        }, expiresIn * 1000);\n    }\n}\nexport const onLogIn = (data) => {\n    return dispatch => {\n        axios.post(\"/login\", data)\n         .then(res => {\n           const { userId, token, expiresIn } = res.data;\n           const expirationDate = new Date (new Date().getTime() + expiresIn * 1000);\n           localStorage.setItem(\"token\", token);\n           localStorage.setItem(\"userId\", userId);\n           localStorage.setItem(\"expiresIn\", expirationDate);\n           dispatch(logInSuccess(res.data.token, userId));\n           dispatch(checkTokenValidity(expiresIn));\n         })\n         .catch(err => {\n             dispatch(logInFailed(err))\n         })\n    }\n}\nconst logInFailed = err => {\n    return {\n        type: actionTypes.LOG_IN_FAILED,\n        error: err \n    }\n}\nconst logout = () => {\n    return {\n        type: actionTypes.LOG_OUT\n    }\n}\n\nexport const onLogout = () => {\n    return dispatch => {\n        //delete token saved in local storage\n        localStorage.removeItem(\"token\");\n        localStorage.removeItem(\"userId\");\n        localStorage.removeItem(\"expiresIn\");\n        dispatch(logout());\n    }\n}\n\nconst authSuccess = (token, userId) => {\n    return {\n        type: actionTypes.ON_AUTH,\n        token: token,\n        userId: userId\n    }\n}\nexport const checkAuthState = () => {\n    return dispatch => {\n        let token = localStorage.getItem('token');\n        if (!token) {\n            dispatch(logout());\n        } else {\n            const expirationDate = new Date (localStorage.getItem('expiresIn'));\n            if (expirationDate <= new Date()){\n                dispatch(logout)\n            } else {\n                const userId = localStorage.getItem('userId');\n                dispatch(authSuccess(token, userId));\n                dispatch(checkTokenValidity((expirationDate.getTime() - new Date().getTime()) / 1000 ));\n            \n            }\n        }\n    }\n}\nconst registered = () => {\n    return {\n        type: actionTypes.ON_REGISTER,\n        \n    }\n}\nconst registrationFailed = err => {\n    return {\n        type: actionTypes.ON_REGISTRATION_FAILED,\n        error: err\n    }\n}\nexport const onRegister = data => {\n    return dispatch => {\n        axios.post(\"/register\", data)\n            .then(res => {\n                dispatch(registered())\n            })\n            .catch(err => {\n                dispatch(registrationFailed(err))\n            });\n    }\n}","export const LOG_IN = \"LOG_IN\";\nexport const LOG_OUT = \"LOG_OUT\";\nexport const LOG_IN_FAILED = \"LOG_IN_FAILED\";\nexport const ON_AUTH = \"ON_AUTH\";\nexport const ON_REGISTER = \"ON_REGISTER\";\nexport const ON_REGISTRATION_FAILED = 'ON_REGISTRATION_FAILED';\n\nexport const PREPARE_CALLER = 'PREPARE_CALLER';\nexport const CALL_INIT = 'CALL_INIT';\nexport const CALL_ACCEPTED = 'CALL_ACCEPTED';\nexport const CALL_REJECTED = 'CALL_REJECTED';\nexport const ON_TRACK = 'ON_TRACK';\nexport const ON_LOCAL_STREAM = 'ON_LOCAL_STREAM';\nexport const ON_INCOMING_CALL = 'ON_INCOMING_CALL';\nexport const END_CALL = 'END_CALL';\n\nexport const CHAT_INIT_SUCCESS = 'CHAT_INIT_SUCCESS';\nexport const FETCH_MESSAGES_SUCCESS = 'FETCH_MESSAGES_SUCCESS';\nexport const ON_NEW_MESSAGE = 'ON_NEW_MESSAGE';\nexport const CREATE_GROUP_SUCCESS = 'CREATE_GROUP_SUCCESS';\nexport const CREATE_GROUP_FAILED = 'CREATE_GROUP_FAILED';\nexport const START_NEW_CHAT_SUCCESS = 'START_NEW_CHAT_SUCCESS';\nexport const START_NEW_CHAT_FAILED = 'START_NEW_CHAT_FAILED';\nexport const DELETE_CHAT = 'DELETE_CHAT';\nexport const JOIN_ROOM = 'JOIN_ROOM';\n","import * as actionTypes from '../actions';\nimport { ChatManager, TokenProvider } from '@pusher/chatkit-client';\nimport axios from '../../../Axios';\n\nlet currentUser;\nlet user;\nexport const chatInit = () => { \n    return (dispatch, getState) => {\n        const {userId} = getState().auth;\n        user = userId;\n        const chatManager = new ChatManager({\n            instanceLocator: 'v1:us1:64b7dbdb-3e59-4fad-9823-83add90cba65',\n            userId: userId,\n            tokenProvider: new TokenProvider({\n                url: 'https://us1.pusherplatform.io/services/chatkit_token_provider/v1/64b7dbdb-3e59-4fad-9823-83add90cba65/token'\n            })\n        });    \n        chatManager\n        .connect({\n            onAddedToRoom: room => {\n                getRooms();\n                // this.setState({showSideDrawer: false, room: room});\n                getMessages(room);\n            }\n        })\n        .then(user => {\n            currentUser = user;\n            dispatch(subscribeToRooms(currentUser))\n            dispatch(chatInitSuccess(currentUser));\n            dispatch(getRooms());\n            // console.log(currentUser.rooms[0].users);\n        })\n        .catch(err => console.log(err));\n    }\n}\nconst getRooms = () => {\n    return dispatch => {\n        const contacts = currentUser.rooms.map(room => {\n            let obj = {};\n            let name = !room.isPrivate ? room.name :\n                        room.name.split('and')\n                            .filter(name => name !== currentUser.id).join('');\n            !name.length ? obj.name = currentUser.id : obj.name = name;\n            obj.id = room.id;\n            return {...room, ...obj};\n        });\n        dispatch({type: 'ON_ROOMS_FETCHED', contacts})\n    }\n}\nconst chatInitSuccess = currentUser => {\n    return {\n        type: actionTypes.CHAT_INIT_SUCCESS,\n        currentUser\n    }\n}\nconst onNewMessage = (message, belongsToCurrentRoom) => {\n    return {\n        type: actionTypes.ON_NEW_MESSAGE,\n        message,\n        belongsToCurrentRoom\n    }\n}\nconst subscribeToRooms = user => {\n    return (dispatch, getState) => {\n        const contacts = user.rooms;\n        contacts.map(con => {\n            return  user.subscribeToRoom({\n                 roomId: con.id,\n                 hooks: {\n                   onMessage: message => {\n                     let belongsToCurrentRoom = false;\n                     const { currentRoom } = getState().chat;\n                    if (currentRoom && currentRoom.id === message.roomId){\n                        belongsToCurrentRoom = true;\n                    } \n                    dispatch(onNewMessage(message, belongsToCurrentRoom));\n                   }\n                 },\n                 messageLimit: 0\n               })\n         })\n    }\n}\n\nconst fetchMessagesSuccess = (messages, room) => {\n    return {\n        type: actionTypes.FETCH_MESSAGES_SUCCESS,\n        messages,\n        room\n    }\n}\nexport const getMessages = room => {\n    return dispatch => {\n        currentUser.fetchMessages({\n            roomId: room['id'],\n            //initialId: 42,\n            direction: 'older',\n            limit: 100,\n          })\n            .then(messages => {\n              dispatch(fetchMessagesSuccess(messages, room));\n            })\n            .catch(err => {\n              console.log(`Error fetching messages: ${err}`);\n            })\n    }\n   \n}\nexport const sendMessage = data => {\n    return dispatch => {\n        currentUser.sendMessage(data);\n    }\n}\nconst createGroupSuccess = () => {\n    return {\n        type: actionTypes.CREATE_GROUP_SUCCESS\n    }\n}\nconst createGroupFailed = err => {\n    return {\n        type: actionTypes.CREATE_GROUP_FAILED,\n        err\n    }\n}\nexport const createNewGroup = data => {\n    return dispatch => {\n        currentUser.createRoom({\n            name: data.name,\n            private: false,\n            addUserIds: data.participants,\n            customData: { foo: 42 },\n          }).then(room => {\n            console.log(`Created room called ${room.name}`);\n            dispatch(createGroupSuccess());\n            dispatch(subscribeToRooms());\n          })\n          .catch(err => {\n            console.log(`Error creating room ${err}`);\n            dispatch(createGroupFailed(err));\n          })\n    }\n}\nconst startNewChatSuccess = () => {\n    return {\n        type: actionTypes.START_NEW_CHAT_SUCCESS\n    }\n}\nconst startNewChatFailed = err => {\n    return {\n        type: actionTypes.START_NEW_CHAT_FAILED,\n        err\n    }\n}\nexport const startNewChat = data => {\n    return dispatch => {\n        let token = localStorage.getItem('token');\n        console.log(data)\n        axios.get(`/search/${data.chatParticipant}`, {headers: {'x-auth-token': token}})\n            .then(res => {\n                currentUser.createRoom({\n                name: `${currentUser.id}and${data.chatParticipant}`,\n                private: true,\n                addUserIds: [data.chatParticipant],\n                customData: {displayImage: res.data.avatar}     \n            })\n                .then(res => {\n                    console.log(res);\n                    dispatch(startNewChatSuccess());\n                    dispatch(subscribeToRooms());\n                })\n                .catch(err => {\n                    console.log(err);\n                    dispatch(startNewChatFailed(err));\n                });\n            })\n            .catch(err => console.log(err));\n    }\n}\nexport const joinRoom = roomId => {\n    return dispatch => {    \n        currentUser.joinRoom({ roomId })\n            .then(room => {\n                console.log(`Joined room with ID: ${room.id}`)\n            })\n            .catch(err => {\n                console.log(`Error joining room ${roomId}: ${err}`)\n            })\n    }\n}\n\nexport const deleteChat = roomId => {\n    return dispatch => {\n        console.log(typeof roomId)\n        currentUser.leaveRoom({ roomId: roomId })\n        .then(() => {\n          console.log(`Deleted room with ID: ${roomId}`);\n          //dispatch(subscribeToRooms());\n        //   dispatch(chatInitSuccess());\n        })\n        .catch(err => {\n          console.log(`Error deleted room ${roomId}: ${err}`)\n        });\n    }\n}","import React from 'react';\n\nimport classes from './Input.module.css';\n\nconst input = ( props ) => {\n    let inputElement = null;\n    let inputClasses = [classes.InputElement];\n\n    if (props.invalid && props.shouldValidate && props.touched){\n        inputClasses.push(classes.Invalid);\n    }\n    switch ( props.elementType ) {\n        case ( 'input' ):\n            inputElement = <input\n                className={inputClasses.join(' ')}\n                {...props.elementConfig}\n                value={props.value}\n                name={props.name}\n                onChange={props.changed} />;\n            break;\n        case ( 'textarea' ):\n            inputElement = <textarea\n                className={inputClasses.join(' ')}\n                {...props.elementConfig}\n                value={props.value}\n                onChange={props.changed} />;\n            break;\n        case ( 'select' ):\n            inputElement = (\n                <select\n                    className={inputClasses.join(' ')}\n                    value={props.value}\n                    onChange={props.changed}>\n                    {props.elementConfig.options.map(option => (\n                        <option key={option.value} value={option.value}>\n                            {option.displayValue}\n                        </option>\n                    ))}\n                </select>\n            );\n            break;\n        default:\n            inputElement = <input\n                className={classes.InputElement}\n                {...props.elementConfig}\n                value={props.value}\n                onChange={props.changed} />;\n    }\n\n    return (\n        <div  className={classes.Input}>\n            <label className={classes.Label}>{props.label}</label>\n            {inputElement}\n        </div>\n    );\n\n};\n\nexport default input;","export const updateObject = (oldObject, updatedProperties) => {\n    return {\n        ...oldObject,\n        ...updatedProperties\n    };\n};\n\nexport const checkValidity = (value, rules) => {\n    \n    let isValid = true;\n    if (!rules) {\n        return true;\n    }\n    \n    if (rules.required) {\n        isValid = value.trim() !== '' && isValid;\n    }\n\n    if (rules.minLength) {\n        isValid = value.length >= rules.minLength && isValid\n    }\n\n    if (rules.maxLength) {\n        isValid = value.length <= rules.maxLength && isValid\n    }\n\n    if (rules.isEmail) {\n        const pattern = /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;\n        isValid = pattern.test(value) && isValid\n    }\n\n    if (rules.isNumeric) {\n        const pattern = /^\\d+$/;\n        isValid = pattern.test(value) && isValid\n    }\n\n    return isValid;\n}","import React, { Component } from 'react';\r\nimport classes from './Register.module.css';\r\nimport { connect } from 'react-redux';\r\nimport * as actionCreators from '../../../store/actions/actionIndex';\r\nimport Input from '../../UI/Input/Input';\r\nimport { checkValidity, updateObject} from '../../../shared/utility';\r\nimport Button from '../../UI/Button/Button';\r\n\r\nclass Register extends Component {\r\n\r\n    state = {\r\n      controls: {\r\n       name: {\r\n          elementType: 'input',\r\n          elementConfig: {\r\n            placeholder: 'Enter your full name',\r\n            type: 'text'\r\n          },\r\n          value: '',\r\n          validation: {\r\n            required: true\r\n          },\r\n          valid: false,\r\n          touched: false\r\n        },\r\n        email: {\r\n            elementType: 'input',\r\n            elementConfig: {\r\n                placeholder: 'Enter your email',\r\n                type: 'email'\r\n            },\r\n            value: '',\r\n            validation: {\r\n                required: true,\r\n                isEmail: true\r\n            },\r\n            valid: false,\r\n            touched: false\r\n        },\r\n        username: {\r\n          elementType: 'input',\r\n          elementConfig: {\r\n              placeholder: 'Enter username',\r\n              type: 'text'\r\n          },\r\n          value: '',\r\n          validation: {\r\n              required: true\r\n          },\r\n          valid: false,\r\n          touched: false\r\n      },  \r\n        password: {\r\n            elementType: 'input',\r\n            elementConfig: {\r\n                placeholder: 'Enter your password',\r\n                type: 'password'\r\n            }, \r\n            value: '',\r\n            validation: {\r\n                required: true,\r\n                minLength: 8\r\n            },\r\n            valid: false,\r\n            touched: false\r\n        },\r\n        password2: {\r\n          elementType: 'input',\r\n          elementConfig: {\r\n              placeholder: 'Confirm your password',\r\n              type: 'password'\r\n          }, \r\n          value: '',\r\n          validation: {\r\n              required: true,\r\n              minLength: 8,\r\n              isEqual: false\r\n          },\r\n          valid: false,\r\n          touched: false\r\n      }\r\n           },\r\n        formIsValid: false\r\n  }\r\n\r\n  onChange = (event, inputIdentifier) => {\r\n    const { value } = event.target;\r\n    const updatedFormElement = updateObject(this.state.controls[inputIdentifier], {\r\n      value: value,\r\n      touched: true,\r\n      valid: checkValidity(value, this.state.controls[inputIdentifier].validation)\r\n  })\r\n  const updatedForm = updateObject(this.state.controls, {\r\n      [inputIdentifier]: updatedFormElement\r\n  });\r\n  let formIsValid = true;\r\n  for (let key in updatedForm){\r\n      formIsValid = updatedForm[key].valid && formIsValid;\r\n  }\r\n  this.setState({controls: updatedForm, formIsValid: formIsValid});\r\n  };\r\n\r\n  onSubmit = event => {\r\n    event.preventDefault();\r\n    let { password, password2} = this.state.controls;\r\n    console.log(password.value, password2.value)\r\n    if (password.value !== password2.value){\r\n      alert('passwords do not match');\r\n    } else {\r\n    const controls = { ...this.state.controls };\r\n    const data = {};\r\n    for (let control in controls){\r\n      data[control] = controls[control]['value'];\r\n    }\r\n    this.props.onRegister(data);\r\n    }\r\n    \r\n  };\r\n\r\n  componentDidUpdate () {\r\n    if (this.props.registrationSuccess){\r\n      this.props.history.push('/login');\r\n    }\r\n  }\r\n  render() {\r\n    let formElements = [];\r\n    for (let key in this.state.controls){\r\n      formElements.push({\r\n        id: key,\r\n        config: this.state.controls[key] \r\n      });\r\n    }\r\n    let form = formElements.map(formElement => {\r\n      return <Input \r\n          key={formElement.id} elementType={formElement.config.elementType}\r\n          elementConfig={formElement.config.elementConfig}\r\n          value={formElement.config.value}\r\n          invalid={!formElement.config.valid}\r\n          shouldValidate={formElement.config.validation}\r\n          touched={formElement.config.touched}\r\n          changed={ event => this.onChange(event, formElement.id)}\r\n            />\r\n    })\r\n    return (\r\n      <div className={classes.RegisterBox}>\r\n        <h2> Register </h2>\r\n        <form onSubmit={this.onSubmit}>\r\n          {form}\r\n          <Button btnType='Success' disabled={!this.state.formIsValid} >Register</Button>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = state => {\r\n  return {\r\n    registrationSuccess: state.auth.registrationSuccess\r\n  }\r\n}\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    onRegister: data => dispatch(actionCreators.onRegister(data))\r\n  }\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Register);\r\n","import React from 'react';\nimport classes from './ErrorBox.module.css'\n\nconst errorBox = error => {\n    console.log(Object.keys(error.error));\n    console.log(error.error.response.data.authError)\n    let errorMessage = '';\n      if (error.error) {\n        errorMessage = error.error.response.data.authError\n      } else {\n        errorMessage = error.message\n      }\n    return (\n        <div className={classes.ErrorBox}>\n            { errorMessage }\n        </div>\n    )\n}\n\nexport default errorBox;","import React, { Component } from \"react\";\r\nimport {Redirect} from 'react-router';\r\nimport { connect } from 'react-redux';\r\nimport * as actionCreators from '../../../store/actions/actionIndex';\r\nimport classes from './Login.module.css'; \r\nimport Input from '../../UI/Input/Input';\r\nimport { checkValidity, updateObject } from '../../../shared/utility';\r\nimport Button from '../../UI/Button/Button'; \r\nimport ErrorBox from '../../UI/ErrorBox/ErrorBox';\r\n\r\nclass Login extends Component {\r\n\r\n  state = {\r\n      controls: {\r\n        email: {\r\n          elementType: 'input',\r\n          elementConfig: {\r\n              placeholder: 'Enter your email',\r\n              type: 'email'\r\n          },\r\n          value: '',\r\n          validation: {\r\n              required: true,\r\n              isEmail: true\r\n          },\r\n          valid: false,\r\n          touched: false\r\n      },\r\n      password: {\r\n        elementType: 'input',\r\n        elementConfig: {\r\n            placeholder: 'Enter your password',\r\n            type: 'password'\r\n        }, \r\n        value: '',\r\n        validation: {\r\n            required: true,\r\n            minLength: 8\r\n        },\r\n        valid: false,\r\n        touched: false\r\n    }\r\n      },\r\n      formIsValid: false\r\n  }\r\n\r\n  onChange = (event, inputIdentifier) => {\r\n    const { value } = event.target;\r\n    const updatedFormElement = updateObject(this.state.controls[inputIdentifier], {\r\n      value: value,\r\n      touched: true,\r\n      valid: checkValidity(value, this.state.controls[inputIdentifier].validation)\r\n    });\r\n    const updatedForm = updateObject(this.state.controls, {\r\n      [inputIdentifier]: updatedFormElement\r\n    });\r\n    let formIsValid = true;\r\n  for (let key in updatedForm){\r\n      formIsValid = updatedForm[key].valid && formIsValid;\r\n  }\r\n  this.setState({controls: updatedForm, formIsValid: formIsValid});\r\n  };\r\n\r\n  onSubmit = e => {\r\n    e.preventDefault();\r\n    const controls = {...this.state.controls}\r\n    const data = {};\r\n    for (let control in controls){\r\n      data[control] = controls[control]['value'];\r\n    }\r\n    this.props.onLogIn(data);\r\n  };\r\n  render() {\r\n    let redirect = null;\r\n    if (this.props.isLoggedIn){\r\n      redirect = <Redirect to=\"/\"/>;\r\n    }\r\n    let formElements = [];\r\n    for (let key in this.state.controls){\r\n      formElements.push({\r\n        id: key,\r\n        config: this.state.controls[key]\r\n      });\r\n    }\r\n    const form = formElements.map(formElement => {\r\n      return <Input \r\n                key={formElement.id} elementType={formElement.config.elementType}\r\n                elementConfig={formElement.config.elementConfig}\r\n                value={formElement.config.value}\r\n                invalid={!formElement.config.valid}\r\n                shouldValidate={formElement.config.validation}\r\n                touched={formElement.config.touched}\r\n                changed={ event => this.onChange(event, formElement.id)}\r\n            />\r\n    })\r\n    return (\r\n      <div className={classes.Login}>\r\n      {redirect}\r\n        <h2> Login </h2>\r\n        { this.props.error && <ErrorBox error={this.props.error}/> }\r\n        <form onSubmit={this.onSubmit}>\r\n          {form}\r\n          <Button btnType='Success' disabled={!this.state.formIsValid}>Log in</Button>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = state => {\r\n  return {\r\n    isLoggedIn: state.auth.token !== null,\r\n    error: state.auth.error\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    onLogIn: (data) => dispatch(actionCreators.onLogIn(data))\r\n  }\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Login);\r\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport * as actionCreators from '../../../store/actions/actionIndex';\n\nclass Logout extends Component {\n    componentDidMount(){\n        this.props.logout();\n        this.props.history.push(\"/\")\n    }\n    render() {\n        return (\n            <div></div>\n        )\n    }\n}\nconst mapDispatchToProps = dispatch => {\n    return {\n        logout: () => dispatch(actionCreators.onLogout())\n    }\n}\nexport default connect(null, mapDispatchToProps)(Logout);","import React, { Component } from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport { connect } from 'react-redux';\r\n\r\nimport classes from \"./Navbar.module.css\";\r\n\r\nclass Navbar extends Component {\r\n  render() {\r\n    let displayedElements = (<ul>\r\n          <li>\r\n            <Link to=\"/\">\r\n              {/* <div className=\"navIcon\">\r\n                <i className=\"fa fa-home\" aria-hidden=\"true\" />\r\n              </div> */}\r\n              <div className={[classes.NavItem, classes.Brand].join(' ')}>\r\n                <span data-text=\"PiperChat\"> </span>\r\n                PiperChat\r\n              </div>\r\n              </Link>\r\n          </li>\r\n          <li>\r\n            <Link to=\"/login\">\r\n              {/* <div className=\"navIcon\">\r\n                <i className=\"fa fa-sign-in\" aria-hidden=\"true\" />\r\n              </div> */}\r\n              <div className={classes.NavItem}>\r\n                <span data-text=\"Login\"> </span>\r\n                Login\r\n              </div>\r\n            </Link>\r\n          </li>\r\n          <li>\r\n            <Link to=\"/register\">\r\n              {/* <div className=\"navIcon\">\r\n                <i className=\"fa fa-user-plus\" aria-hidden=\"true\" />\r\n              </div> */}\r\n              <div className={classes.NavItem}>\r\n                <span data-text=\"Register\"> </span>\r\n                Register\r\n              </div>\r\n            </Link>\r\n          </li>\r\n        </ul>);\r\n        if (this.props.isLoggedIn){\r\n          displayedElements = (<ul>\r\n          <li>\r\n            <Link to=\"/\">\r\n              {/* <div className=\"navIcon\">\r\n                <i className=\"fa fa-home\" aria-hidden=\"true\" />\r\n              </div> */}\r\n              <div className={classes.NavItem}>\r\n                <span data-text=\"PiperChat\"> </span>\r\n               PiperChat\r\n              </div>\r\n              </Link>\r\n          </li>\r\n          <li>\r\n            <Link to=\"/logout\">\r\n              {/* <div className=\"navIcon\">\r\n                <i className=\"fa fa-sign-out\" aria-hidden=\"true\" />\r\n              </div> */}\r\n              <div className={classes.NavItem}>\r\n                <span data-text=\"Logout\"> </span>\r\n                Logout\r\n              </div>\r\n            </Link>\r\n          </li>\r\n          </ul>);\r\n        }\r\n    return (\r\n      <div className={classes.Navbar}>\r\n        {displayedElements}\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = state => {\r\n  return {\r\n    isLoggedIn: state.auth.token !== null\r\n  }\r\n}\r\nexport default connect(mapStateToProps)(Navbar);\r\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport classes from './OptionsDropbar.module.css';\nimport * as chatActionCreators from '../../../store/actions/actionIndex';\n\nclass OptionsDropbar extends Component {\n\n    state = {\n        options: this.props.options || []\n    }\n    componentDidMount () {\n        document.addEventListener('click', this.hideOptions);\n        window.onresize = this.props.hideOptions;\n    }\n    hideOptions = event => {\n        if (this.optionsRef && !this.optionsRef.contains(event.target)){\n            this.props.hideOptions();\n        }\n    }\n    componentWillUnmount(){\n        document.removeEventListener('click', this.hideOptions);\n    }\n    optionClicked = (event, option) => {\n        switch(option.name){\n            case 'Archive chat':\n                alert('Archive chat');\n                break;\n            case 'Mute': \n                alert('Mute');\n                break;\n            case 'Exit group':\n                this.props.deleteChat(this.props.roomId)\n                break;\n            case 'Delete chat':\n                this.props.deleteChat(this.props.roomId);\n                break;\n            default:\n                break;\n        }\n    }\n    render(){\n        let options = null;\n        if (this.props.show){\n            options = (\n                <ul ref={ ul => this.optionsRef = ul} className={classes.OptionsDropbar} style={{top: this.props.position.y  + 'px',\n                left: this.props.position.x - 200 + 'px'\n                }}>\n                    {this.state.options.map((option, i) => {\n                        return <li key={i} onClick={(event)=>this.optionClicked(event, option)} >{option.name}</li>\n                    })}\n                </ul>\n            )\n        }\n        return options;\n        // <div className={classes.OptionsDropbar}>{options}</div>;\n    }\n}\nconst mapDispatchToProps = dispatch => {\n    return {\n        deleteChat: roomId => dispatch(chatActionCreators.deleteChat(roomId))\n    }\n}\nexport default connect(null, mapDispatchToProps)(OptionsDropbar);","import React, { useState, useEffect } from 'react';\nimport classes from './Contact.module.css';\nimport img from '../../assets/images/p37605.png'\nimport { connect } from 'react-redux';\nimport OptionsDropbar from '../../components/UI/OptionsDropbar/OptionsDropbar';\n\nconst contact = props => {\n    const [showOptions, toggleShowOptions] = useState(false);\n    const [position, updatePosition] = useState({});\n    \n    const showOptionsHandler = event => {\n        event.stopPropagation();\n        let pos = {};\n        pos.x = event.clientX + 200;\n        pos.y = event.clientY;\n        toggleShowOptions(true);\n        updatePosition(pos)\n    }\n    const hideOptions = () => {\n        toggleShowOptions(false);\n        updatePosition({})\n    }\n    let attachedClasses = [classes.Contact];\n    let unreadMessages = \"\";\n    if (props.Active){\n        attachedClasses.push(classes.Active); \n    }\n    if (props.unopenedMessages[props.id]){\n        unreadMessages = props.unopenedMessages[props.id].length;\n    }\n    let contact = null;\n    if (props.room){\n        contact = (<div className={attachedClasses.join(' ')} onClick={props.clicked}>\n        <span className={classes.ImageContainter}><img src={img} alt=''/></span>\n        <div>\n            <p>{props.room.name}</p>\n            <p>{props.lastMessage}</p>\n        </div>\n        <div className={classes.FloatedRight}>\n            <span>{unreadMessages}</span>\n            <i onClick={showOptionsHandler} className=\"fa fa-angle-down\"></i>\n            { showOptions && \n                <OptionsDropbar position={position} \n                        roomId={props.room.id}\n                        show={showOptions} \n                        hideOptions={hideOptions}\n                        options={[{name: 'Archive chat'},\n                        {name: 'Mute'},\n                        {name: !props.room.isPrivate ? 'Exit group':'Delete chat'},\n                        {name: 'Pin chat'},\n                        {name: 'Mark as unread'}\n                        ]}/>}\n        </div>\n    </div>\n        )\n    }\n    return contact; \n}\nconst mapStateToProps = state => {\n    return {\n         userId: state.auth.userId\n    }\n}\nexport default connect(mapStateToProps)(contact);","import React from 'react';\nimport classes from './Chat.module.css';\n\n\nconst chat = props => {\n    let attachedClasses = [classes.Chat];\n    if (props.byCurrentUser){\n        attachedClasses = [classes.ByCurrentUser];\n    }\n    return (\n        // <div className={classes.Wrapper} style={{position: 'relative'}}>\n            <div className={attachedClasses.join('')}>\n                <li>\n                    <span className={classes.Sender}>{props.sender}</span>\n                    <br />\n                    <span className={classes.Text}>{props.text}</span>\n                </li>        \n            </div>\n        // </div>\n    )\n}\n\nexport default chat;","import React from 'react';\nimport { connect } from 'react-redux';\nimport * as chatActionCreators from '../../../../../store/actions/actionIndex';\nimport classes from './JoinableRoom.module.css';\n\nconst joinableRoom = props => {\n    return (\n    <span onClick={props.joinRoom(props.id)} className={classes.JoinableRoom}>\n        <img src={props.groupImage} alt='' />\n        <span>\n            <p>{props.name}</p>\n            <p>{props.lastMessage}</p>\n        </span>\n    </span>\n    )\n}\n\nconst mapDispatchtoProps = dispatch => {\n    return {\n        joinRoom: id => dispatch(chatActionCreators.joinRoom(id))\n    }\n}\nexport default connect(null,mapDispatchtoProps)(joinableRoom);","import React from 'react';\nimport JoinableRoom from './JoinableRoom/JoinableRoom';\nconst joinableRooms = props => {\n    return (\n    <React.Fragment>\n        {props.joinableRooms.map((room, i) => {\n            return <JoinableRoom key={i} groupImage={room.groupImage} \n            name={room.name} id={room.id} lastMessage={room.lastMessage}/>\n        })}\n    </React.Fragment>)\n}\n\nexport default joinableRooms;","import React, {Component} from 'react'; \nimport classes from './SideDrawer.module.css';\nimport axios from '../../../Axios';\nimport { connect } from 'react-redux';\nimport JoinableRooms from './JoinableRooms/JoinableRooms';  \nimport * as actionCreators from '../../../store/actions/actionIndex';\nimport Input from '../Input/Input';\nimport Button from '../Button/Button'\n\n\nclass SideDrawer extends Component {\n        state = {\n            showCreateForm: false,\n            showNewChatForm: false,\n            groupName: '',\n            participants: [],\n            potentialParticipants: [],\n            newGroupChatParticipants: {},\n            privateChatParticipant: '',\n            joinableRooms: [],\n            ShowJoinableRoomsList: false,\n            touched: false,\n            isValid: false\n        }\n        createNewGroupHandler = () => {\n            let potentialParticipants = this.props.user.rooms.filter(user => user.isPrivate && user.name !== this.props.userId);\n            let chatParticipants = {};\n            potentialParticipants.forEach(pp => chatParticipants[pp.name] = false);\n            this.setState(prevState => {\n                return {\n                showCreateForm: !prevState.showCreateForm, \n                potentialParticipants, \n                ShowJoinableRoomsList: false,\n                showNewChatForm: false,\n                newGroupChatParticipants: chatParticipants \n             }\n            });\n            \n        }\n        onChange = (event) => {\n            // let valid = false; \n            // if (this.state[name] !== \"\"){\n            //     valid = true;\n            // }\n            this.setState({[event.target.name]: event.target.value});\n            \n        }\n        onCreateNewGroup = event => {\n            event.preventDefault();\n            let obj = {...this.state.newGroupChatParticipants};\n            let participants = Object.keys(obj).filter(j => obj[j]);\n            this.props.onCreateNewGroup({participants, name: this.state.groupName});\n            this.setState({groupName: '', newGroupChatParticipants: {}});\n        }\n        startNewChatHandler = () => {\n            this.setState(prevState => {\n                return {\n                showNewChatForm: !prevState.showNewChatForm, \n                ShowJoinableRoomsList: false, \n                showCreateForm: false\n            }})\n            \n        }\n        onStartNewChat = event => {\n            event.preventDefault();\n            let data = {chatParticipant: this.state.privateChatParticipant};\n            this.props.onStartNewChat(data);\n        }\n        joinGroup = () => {\n            this.props.user.getJoinableRooms()\n            .then(rooms => {\n                this.setState(prevState => {\n                    return {\n                        joinableRooms: rooms, \n                        ShowJoinableRoomsList: !prevState.ShowJoinableRoomsList,\n                        showCreateForm: false,\n                        showNewChatForm: false\n                    }\n                });\n              \n            })\n            .catch(err => {\n              console.log(`Error getting joinable rooms: ${err}`)\n            })\n        }\n        onPPChange = event => {\n            let { name, checked } = event.target;\n            let groupParticipants = {...this.state.newGroupChatParticipants};\n            groupParticipants[name] = checked;\n            this.setState({newGroupChatParticipants: groupParticipants});\n        } \n    render (){\n        let attachedClasses = [classes.SideDrawer, classes.Close];\n        if (this.props.show){\n            attachedClasses = [classes.SideDrawer, classes.Open];\n        }\n       return  (\n        <div className={attachedClasses.join(' ')}>\n            <div className={classes.divs} onClick={this.createNewGroupHandler}>Create a new group</div>\n            <form onSubmit={this.onCreateNewGroup} style={{display: this.state.showCreateForm ? 'block' : 'none'}}>\n                <Input \n                elementType='input'\n                elementConfig={{placeholder: 'Enter group name', type: 'text'}}\n                value={this.state.groupName}\n                invalid={this.state.isTouched && !this.state.isValid}\n                shouldValidate={true}\n                touched={this.state.isTouched}\n                name='groupName'\n                changed={ event => this.onChange(event, 'groupName')}\n            />\n                <h3>Add participants</h3>\n                {this.state.potentialParticipants.map((pp, i) => {\n                    return (\n                        <span key={i} className={classes.PP}>\n                            <input onChange={this.onPPChange} type=\"checkbox\" name={pp.name} checked={this.state.newGroupChatParticipants[pp.name]}/>\n                            <label htmlFor={pp.name}>{pp.name}</label>\n                        </span>\n                    )\n                })}\n                \n                <Button /*disabled={!this.state.groupName  && \n                !Object.keys(this.state.newGroupChatParticipants).map(key => {\n                    return this.state.newGroupChatParticipants[key]\n                }).includes(true)}*/ btnType='Success'>Create</Button>\n            </form>\n            <div className={classes.divs} onClick={this.joinGroup}>Join a group</div>\n            <span style={{display: this.state.ShowJoinableRoomsList ? 'block' : 'none'}} className={classes.RoomsList}>\n                <JoinableRooms joinableRooms={this.state.joinableRooms} />  \n            </span>\n            <div className={classes.divs} onClick={this.startNewChatHandler}>Start a new chat</div>\n            <form onSubmit={this.onStartNewChat} style={{display: this.state.showNewChatForm ? 'block' : 'none'}}>\n                <input onChange={this.onChange} type='text' name='privateChatParticipant' placeholder='Who do you wanna chat with?' />    \n                <button>Submit</button>\n            </form>\n        </div>\n        );\n    \n}\n}\nconst mapStateToProps = state => {\n    return {\n        token: state.auth.token,\n        userId: state.auth.userId\n    }\n}\nconst mapDispatchToProps = dispatch => {\n    return {\n        onCreateNewGroup: data => dispatch(actionCreators.createNewGroup(data)),\n        onStartNewChat: data => dispatch(actionCreators.startNewChat(data)),\n    }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(SideDrawer);","import React, {Component} from 'react';\nimport classes from './Modal.module.css';\nimport Backdrop from '../../components/UI/Backdrop/Backdrop';\nclass Modal extends Component {\n    render(){\n        let modal = null;\n        if (this.props.show){\n            modal = (\n            <React.Fragment>\n                {/* <Backdrop show={this.props.show} clicked={this.props.backdropClicked}/> */}\n                <div className={classes.Modal}>{this.props.children}</div>\n            </React.Fragment>\n        );\n        } \n        return modal;\n    \n    }\n}\n\nexport default Modal;","import React, { Component} from 'react';\nimport classes from './Call.module.css';\nimport { connect } from 'react-redux';\nimport * as callActionCreators from '../../store/actions/actionIndex'\n\nimport Button from '../../components/UI/Button/Button';\n\nclass Call extends Component {\n    \n    state = {\n          id: null,\n          room: null\n    }\n       \n    componentDidMount (){\n        if (this.props.role === 'callee'){\n            this.setState({room: this.props.caller});\n        } else {\n            this.props.callUser(this.props.callTo, this.props.callType);\n            this.setState({room: this.props.callTo});\n        }\n        this.props.channel.on('message', data => {\n            if (JSON.parse(data).type === 'leave'){\n                if (!this.props.role){\n                    this.props.closeModal();\n                }\n            }\n        })\n    }\n       \n    \n    endCall = () => {\n        this.setState({room: null});\n        this.props.endCall();\n        if (!this.props.role){\n            this.props.closeModal();\n        }\n    }\n    \n   \n    \n    \n    componentDidUpdate () {\n        if (this.props.callType === 'video'){\n            this.localVideoRef.srcObject = this.props.localStream;\n            this.remoteVideoRef.srcObject = this.props.remoteStream;\n        } else {\n            this.localAudioRef.srcObject = this.props.localStream;\n            this.remoteAudioRef.srcObject = this.props.remoteStream;\n        }\n    }\n       \n    render () {\n        let call = null;\n        if (this.props.callType === 'video'){\n            call = (\n                <React.Fragment>\n                    <div className={classes.videoContainer}>\n                        <video className={classes.LocalVideo} autoPlay muted  \n                            ref={(lVid)=> this.localVideoRef = lVid}>\n                        </video>\n\n                        <video className={classes.RemoteVideo} autoPlay  \n                        ref={(rVid)=> this.remoteVideoRef = rVid}>\n                        </video>\n                    </div>\n                </React.Fragment>\n            );\n        } else {\n            call = (\n                <React.Fragment>\n                    <audio autoPlay src={this.props.localStream} muted ref={audio => this.localAudioRef = audio} />\n                    <audio autoPlay src={this.props.remoteStream} ref={audio => this.remoteAudioRef = audio} />\n                </React.Fragment>\n            )\n        }\n        return (\n            <div className={classes.Call}>\n                {call}\n                <div className={classes.Buttons}>\n                    {/* <span style={{color: 'red'}}><i class=\"fas fa-window-close\"></i></span> */}\n                    <Button clicked={this.endCall} btnType='Danger'>End Call</Button>\n                </div>\n            </div>\n        )\n    }\n}\nconst mapStateToProps = state => {\n    return {\n        userId: state.auth.userId,\n        channel: state.call.channel,\n        remoteStream: state.call.remoteStream,\n        localStream: state.call.localStream,\n        incomingCall: state.call.incomingCall,\n        caller: state.call.caller\n    }\n}\nconst mapDispatchToProps = dispatch => {\n    return {\n        callUser: (user, callType) => dispatch(callActionCreators.callUser(user, callType)),\n        endCall: () => dispatch(callActionCreators.endCall())\n    }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(Call);","import React, {Component} from 'react';\nimport { connect } from 'react-redux';\nimport classes from './ChatScreenBar.module.css';\nimport Modal from '../../containers/Modal/Modal';\nimport Call from '../../containers/Call/Call';\nimport OptionsDropbar from '../UI/OptionsDropbar/OptionsDropbar';\n\n\nclass ChatScreenBar extends Component {\n    state = {\n        showModal: false,\n        isVideo: false,\n        callType: '',\n        showOptions: false,\n        position: {}\n    }\n    \n    onVideoCallInit = () => {\n            this.setState({showModal: true, callType: 'video', isVideo: true});\n    }\n\n    onVoiceCallInit = () => {\n        this.setState({showModal: true, isVideo: false, callType: 'audio'});\n    }\n\n    showOptions = event => {\n        let pos = {...this.state.position};\n        pos.x = event.clientX;\n        pos.y = event.clientY;\n        this.setState({showOptions: true, position: pos})\n    }\n    hideOptions = () => {\n        this.setState({showOptions: false, position:{}})\n    }\n    \n    endCall = () => {\n        this.setState({showModal: false})\n    }\n    render() {\n        let optionsDropbar = null;\n        if (this.state.showOptions){\n           optionsDropbar = <OptionsDropbar hideOptions={this.hideOptions} \n                                position={this.state.position} \n                                show={this.state.showOptions} \n                                options={[{name: 'Contact info'},\n                                {name: 'Select messages'},\n                                {name: 'Mute'},\n                                {name: 'Clear messages'},\n                                {name: 'Delete chat'}\n                                ]}/>\n              \n        }\n        return (\n            <div className={classes.ChatScreenBar}>\n            <div>\n                   <img src='https://ichef.bbci.co.uk/images/ic/720x405/p0517py6.jpg' alt=''/>\n                   <span>{this.props.room.name}</span>\n               </div>\n               <div className={classes.FA}>\n                    {  this.props.room.isPrivate &&  <React.Fragment><i onClick={this.onVideoCallInit} className=\"fa fa-video\"></i>\n                    <i onClick={this.onVoiceCallInit} className=\"fa fa-phone\"></i>\n                    </React.Fragment>\n                    }\n                    <i className='fa fa-ellipsis-v' onClick={event => this.showOptions(event)}></i>\n                    {optionsDropbar}\n               </div>\n               <Modal show={this.state.showModal}>\n                    {this.state.callType ? \n                        <Call callTo={this.props.room.name} closeModal={this.endCall} callType={this.state.callType}/> : \n                        null\n                    }\n                </Modal>\n            </div>\n        )\n    } \n}\nconst mapStateToProps = state => {\n    return {\n        callEnded: state.call.callEnded,\n        callStarted: state.call.callOngoing\n    }\n}\n export default connect(mapStateToProps)(ChatScreenBar);","import React from 'react';\nimport classes from './Spinner.module.css';\n\n\nconst spinner = ( props ) => (\n    <div className={classes.Spinner}><div></div><div></div></div>\n);\n\nexport default spinner;","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport Contact from './Contact';\nimport Chat from './Chat';\nimport classes from './ChatScreen.module.css';\nimport SideDrawer from '../../components/UI/SideDrawer/SideDrawer';\nimport ChatScreenBar from '../../components/ChatScreenBar/ChatScreenBar';\nimport Modal from '../Modal/Modal';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport * as actionCreators from '../../store/actions/actionIndex';\n\n\n\nclass ChatScreen extends Component {\n\n    state = {\n        text: '',\n        showSideDrawer: false,\n        contacts: []\n    }\n    componentDidMount () {\n        this.props.chatInit();\n        this.scrollToBottom();\n    }\n    scrollToBottom = () => {\n       if (this.scrollRef && this.props.messages.length > 0){\n        let lastElement = this.scrollRef.children[this.scrollRef.children.length-1];\n        lastElement.scrollIntoView();\n        console.log(lastElement);\n    }\n}\n    getMessages = room => { \n        this.props.getMessages(room);\n        this.scrollToBottom();\n    }\n\n    onChange = event => {\n        this.setState({text: event.target.value});\n    }\n    onSubmit = event => {\n        event.preventDefault();\n        let data = {\n            text: this.state.text,\n            roomId: this.props.currentRoom.id\n        }\n        this.props.sendMessage(data);\n        this.setState({text: ''});\n    }\n\n   toggleSideDrawer = () => {\n        this.setState(prevState => {\n            return {showSideDrawer: !prevState.showSideDrawer}});\n    }\n\n    componentDidUpdate () {\n        this.scrollToBottom();\n    }\n    render () {  \n        console.log(this.state.contacts);\n        let chat = <Modal show={true}>\n                        <Spinner />\n                    </Modal>\n        if (this.props.currentRoom){\n            chat = (\n            <div className={classes.Chat}>\n                <ChatScreenBar room={this.props.currentRoom} endCall={this.props.endCall}/>\n                <div className={classes.Msgs} ref={(div) => {this.scrollRef = div}}>\n                {\n                    this.props.messages.map(msg => {\n                        return (\n                            <Chat sender={msg.senderId} byCurrentUser={this.props.userId === msg.senderId}\n                            text={msg.text} key={msg.id} />\n                        )\n\n                    })\n                }\n                </div>\n           \n            <form onSubmit={this.onSubmit}>\n                <input onChange={this.onChange} value={this.state.text} name='text' type=\"text\" placeholder=\"Enter message\" />\n            </form>\n            </div>\n            );\n        } else {\n            chat = (\n                <div className={classes.Chat}></div>\n            );\n        }\n        let contactsPane = null;\n        if (this.props.chatkitUser){\n            contactsPane = (\n                <div className={classes.ContactsPane} >\n                <SideDrawer show={this.state.showSideDrawer} \n                user={this.props.chatkitUser}\n                />\n                <div className={classes.MenuBar}>\n                    <i onClick = {this.toggleSideDrawer} className=\"fa fa-bars\"></i>\n                </div>\n                <h1 style={{textAlign: 'center'}}>Contacts</h1>\n                {this.props.contacts.length && this.props.contacts.map(con => {\n                    return <Contact key={con.id} name={con.name} \n                                room={con}\n                                user={this.props.userId}\n                                unopenedMessages={this.props.unopenedMessages}\n                                Active={this.props.currentRoom ? \n                                    con.id === this.props.currentRoom.id : \n                                    false } \n                                clicked={() => this.getMessages(con)}\n                            />\n                })}\n                </div>\n            );\n            \n        }\n        return (\n            <div className={classes.ChatScreen}>\n                {contactsPane}\n                {chat}\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        userId: state.auth.userId,\n        channel: state.call.channel,\n        chatkitUser: state.chat.currentUser,\n        currentRoom: state.chat.currentRoom,\n        messages: state.chat.messages,\n        endCall: state.call.endCall,\n        unopenedMessages: state.chat.unopenedMessages,\n        contacts: state.chat.contacts\n    }\n}\nconst mapDispatchToProps = dispatch => {\n    return {\n        chatInit: () => dispatch(actionCreators.chatInit()),\n        getMessages: room => dispatch(actionCreators.getMessages(room)),\n        sendMessage: data => dispatch(actionCreators.sendMessage(data))\n    }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatScreen);","import React, { Component } from \"react\";\nimport {Route, withRouter, Switch, Redirect } from \"react-router-dom\";\nimport { connect } from 'react-redux';\nimport IncomingCall from './containers/Call/IncomingCallNotification/IncomingCall';\nimport Register from \"./components/Auth/Register/Register\";\nimport Login from \"./components/Auth/Login/Login\";\nimport Logout from \"./components/Auth/Logout/Logout\";\nimport Navbar from \"./components/UI/Navigation/Navbar\";\nimport ChatScreen from './containers/PiperChat/ChatScreen';\nimport * as actionCreators from './store/actions/actionIndex';\nimport Call from './containers/Call/Call';\nimport \"./App.css\";\nimport Modal from \"./containers/Modal/Modal.js\";\n\nimport ringtone from './assets/audio/iphone_trap_remix.mp3';\n\n\nclass App extends Component {\n\n  state = {\n    showCallNotification: false\n  }\n  componentDidMount() {\n    this.props.onAuth();\n    if (!this.props.isLoggedIn){\n      this.props.history.push('/login')\n    } \n  }\n  \n  componentDidUpdate () {\n    if (this.props.isLoggedIn){\n      if (!this.props.channel){\n        this.props.getCallerReady();\n      }\n    }\n  }\n  acceptCall = () => {\n    this.ringtoneRef.pause();\n    this.ringtoneRef.currentTime = 0;\n    this.props.callAccepted();\n  }\n\n  rejectCall = () => {\n    this.ringtoneRef.pause();\n    this.ringtoneRef.currentTime = 0;\n    this.props.callRejected();\n  }\n  render() {\n    let chatScreen = null;\n      if (this.props.isLoggedIn){\n        if (this.props.incomingCall){\n          this.ringtoneRef.play();\n          chatScreen = (\n            <IncomingCall acceptCall={this.acceptCall}\n              rejectCall={this.rejectCall}\n              caller={this.props.caller}\n              callType={this.props.callType}\n            />\n          );\n      } else if (this.props.callOngoing){\n        chatScreen = (\n          <React.Fragment>\n            <Modal show><Call role='callee' callType={this.props.callType}/></Modal>\n            <ChatScreen />\n          </React.Fragment>\n          );\n      } else {\n        chatScreen = <ChatScreen />\n      }\n    } \n    return (\n        <div>\n          <Navbar />\n          <div className=\"container\">\n            {chatScreen}\n            <audio src={ringtone} loop ref={ ring => this.ringtoneRef = ring } />\n            <Switch>\n              <Route path=\"/register\" component={Register} />\n              <Route path=\"/login\" component={Login} />\n              <Route path=\"/logout\" component={Logout} />\n              { !this.props.isLoggedIn && <Redirect to='/login' />}\n            </Switch>\n          </div>\n        </div>\n    );\n  }\n}\nconst mapStateToProps = state => {\n  return {\n    isLoggedIn: state.auth.token !== null,\n    incomingCall: state.call.incomingCall,\n    callType: state.call.callType,\n    channel: state.call.channel,\n    caller: state.call.caller,\n    callOngoing: state.call.callOngoing\n  }\n}\nconst mapDispatchToProps = dispatch => {\n  return {\n    onAuth: () => dispatch(actionCreators.checkAuthState()),\n    getCallerReady: () => dispatch(actionCreators.getCallerReady()),\n    callAccepted: () => dispatch(actionCreators.callAccepted()),\n    callRejected: () => dispatch(actionCreators.callRejected())\n  }\n}\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(App));\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import * as actionTypes from '../actions/actions';\n\nconst initialState = {\n    token: null,\n    userId: null,\n    registrationSuccess: false,\n    error: null\n}\n\nconst authReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case actionTypes.LOG_IN:\n           return {\n               ...state, token: action.token, userId: action.userId, error: null\n           }\n        case actionTypes.LOG_OUT:\n            return {\n                ...state, token: null, userId: null\n            }\n        case actionTypes.ON_AUTH:\n            return {\n                ...state, token: action.token, userId: action.userId\n            }\n        case actionTypes.ON_REGISTER: \n            return {\n                ...state, registrationSuccess: true\n            }\n        case actionTypes.LOG_IN_FAILED: \n        return {\n            ...state, error: action.error\n        }\n        default: \n            return state;\n    }\n}\n\nexport default authReducer;","import * as actionTypes from '../actions/actions';\n\nconst initialState = {\n    channel: null,\n    remoteStream: null,\n    localStream: null,\n    incomingCall: false,\n    callType: null,\n    caller: null,\n    callOngoing: false,\n    callStarted: false,\n    callEnded: false\n}\n\nconst callReducer = (state = initialState, action) => {\n    \n    switch(action.type){\n        case actionTypes.PREPARE_CALLER: \n            \n            return {\n                ...state,\n                channel: action.channel \n            }\n        case actionTypes.CALL_INIT: \n            return {\n                ...state, callStarted: true, callEnded: false\n            }\n        case actionTypes.ON_TRACK: \n            return {\n                ...state, remoteStream: action.remoteStream\n            }\n        case actionTypes.ON_LOCAL_STREAM:\n            return {\n                ...state, localStream: action.stream\n            }\n        case actionTypes.ON_INCOMING_CALL:\n            return {\n                ...state, incomingCall: true, callType: action.callType, caller: action.caller\n            }\n        case actionTypes.CALL_ACCEPTED: \n            return {\n                ...state, incomingCall: false, callOngoing: true\n            }\n        case actionTypes.CALL_REJECTED: \n            return {\n                ...state, incomingCall: false, callOngoing: false\n            }\n        case actionTypes.END_CALL: \n            return {\n                ...state, callOngoing: false, incomingCall: false, callEnded: true, callStarted: false\n            }\n        default: \n        return state;\n    }\n}\n\nexport default callReducer;","import * as actionTypes from '../actions/actions';\n\n\nconst initialState = {\n    currentUser: null,\n    contacts: [],\n    currentRoom: null,\n    messages: [],\n    unopenedMessages: {}\n};\n\nconst removeItem = (obj, item) => {\n    return Object.keys(obj).reduce((acc, key) => {\n        if (key !== item) {\n          return {...acc, [key]: obj[key]}\n        }\n        return acc;\n      }, {})\n} \nconst chatReducer = (state = initialState, action) => {\n    switch (action.type){\n        case actionTypes.CHAT_INIT_SUCCESS:\n            return {\n                ...state, currentUser: action.currentUser\n            }\n        case actionTypes.FETCH_MESSAGES_SUCCESS: {\n            return {\n                ...state, messages: action.messages, currentRoom: action.room,\n                unopenedMessages: removeItem(state.unopenedMessages, action.room.id)\n            }\n        }\n        case actionTypes.ON_NEW_MESSAGE: \n            if (action.belongsToCurrentRoom){\n                return {\n                    ...state, messages: [...state.messages, action.message]\n                }\n            } else {\n                let unopenedMessagesCopy = {...state.unopenedMessages};\n                if (unopenedMessagesCopy.hasOwnProperty(action.message.roomId)){\n                    unopenedMessagesCopy[action.message.roomId].push(action.message);\n                } else {\n                    unopenedMessagesCopy[action.message.roomId] = [action.message];\n                }\n                return { \n                    ...state, unopenedMessages: unopenedMessagesCopy\n               }  \n            }\n        case 'ON_ROOMS_FETCHED':\n            return {\n                ...state, contacts: action.contacts\n            }\n        default: \n            return state;\n    }\n}\n\nexport default chatReducer;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter } from 'react-router-dom';\nimport { createStore, applyMiddleware, compose, combineReducers  } from 'redux';\nimport { Provider } from 'react-redux';\nimport thunk from 'redux-thunk';\nimport * as serviceWorker from './serviceWorker';\nimport authReducer from './store/reducers/authReducer'\nimport callReducer from './store/reducers/callReducer';\nimport chatReducer from './store/reducers/chatReducer';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst rootReducer = combineReducers({\n    auth: authReducer,\n    call: callReducer,\n    chat: chatReducer\n})\nexport const store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)));\n\nReactDOM.render(<Provider store={store}><BrowserRouter><App /></BrowserRouter></Provider>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ChatScreen\":\"ChatScreen_ChatScreen__f3ASK\",\"ContactsPane\":\"ChatScreen_ContactsPane__oN7uv\",\"MenuBar\":\"ChatScreen_MenuBar__3amOs\",\"Chat\":\"ChatScreen_Chat__lflmZ\",\"Msgs\":\"ChatScreen_Msgs__BXnEQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Input\":\"Input_Input__2JpFs\",\"Label\":\"Input_Label__25WBL\",\"InputElement\":\"Input_InputElement__3gpth\",\"Invalid\":\"Input_Invalid__36Y0Z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Call\":\"Call_Call__3l6pP\",\"videoContainer\":\"Call_videoContainer__1sVsi\",\"RemoteVideo\":\"Call_RemoteVideo__3Skxg\",\"Buttons\":\"Call_Buttons__GaIlG\",\"LocalVideo\":\"Call_LocalVideo__1gYIO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Contact\":\"Contact_Contact__2so_U\",\"Active\":\"Contact_Active__2qRCp\",\"ImageContainer\":\"Contact_ImageContainer__3IJBj\",\"FloatedRight\":\"Contact_FloatedRight__267Po\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Chat\":\"Chat_Chat__3acdB\",\"ByCurrentUser\":\"Chat_ByCurrentUser__3XcsR\",\"Sender\":\"Chat_Sender__1N0Vs\",\"Text\":\"Chat_Text__1m-V9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Button\":\"Button_Button__bbgQI\",\"Success\":\"Button_Success__1lcYy\",\"Danger\":\"Button_Danger__2mmcy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"IncomingCall\":\"IncomingCall_IncomingCall__aXyN4\",\"Buttons\":\"IncomingCall_Buttons__3nY74\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ChatScreenBar\":\"ChatScreenBar_ChatScreenBar__1Jt4T\",\"FA\":\"ChatScreenBar_FA__2AkgL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"RegisterBox\":\"Register_RegisterBox__360id\",\"registerBox\":\"Register_registerBox__3RCyM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Login\":\"Login_Login__3PEic\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ErrorBox\":\"ErrorBox_ErrorBox__lNSGC\"};","module.exports = __webpack_public_path__ + \"static/media/p37605.8335e87d.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"OptionsDropbar\":\"OptionsDropbar_OptionsDropbar__1SECF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"JoinableRoom\":\"JoinableRoom_JoinableRoom__3ArHN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Modal\":\"Modal_Modal__2h4R2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Backdrop\":\"Backdrop_Backdrop__2NM2A\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Spinner\":\"Spinner_Spinner__hgVnm\"};","module.exports = __webpack_public_path__ + \"static/media/iphone_trap_remix.d21333e9.mp3\";"],"sourceRoot":""}